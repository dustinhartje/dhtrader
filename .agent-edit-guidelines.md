# Agent Edit Guidelines - Mandatory for All File Changes

**Date Created:** March 1, 2026
**Applies To:** All automated edits, code generation, file modifications
**Critical:** These rules MUST be enforced on EVERY change

## Rule 1: Maximum Line Length - 79 Characters (PYTHON FILES ONLY)

**Canonical Definition:** See [CODING_STANDARDS.md](CODING_STANDARDS.md)
section "Line Length Limit: 79 Characters" for complete details.

**Summary:** Python files shall not exceed 79 characters per line.

**When to Apply:**
- Python source files (.py): ALL lines (code and comments)
- Python test files: ALL lines
- Note: This rule does NOT apply to configuration files, markdown,
  shell scripts, or other file types

**Validation Commands:**
See [CODING_STANDARDS.md section "Validation Command
Reference"](CODING_STANDARDS.md#validation-command-reference) for bash
commands to check line length before and after editing.

**How to Comply:**
1. Break long strings using parentheses:
   ```python
   # BAD (85 chars)
   result = sym.market_is_open(
       trading_hours="eth",
       target_dt=f"{date} 16:15:00"
   )

   # GOOD (multiple lines < 79)
   result = sym.market_is_open(
       trading_hours="eth",
       target_dt=f"{date} 16:15:00"
   )
   ```

2. Break long assertions:
   ```python
   # BAD
   assert sym.market_is_open(
       trading_hours="eth",
       target_dt=f"{date} 16:15:00",
       check_closed_events=False
   )

   # GOOD
   assert sym.market_is_open(
       trading_hours="eth",
       target_dt=f"{date} 16:15:00",
       check_closed_events=False
   )
   ```

3. Use line continuation for imports/statements:
   ```python
   # BAD (too long)
   from some_module import (
       LongClassName,
       AnotherLongClassName,
       ThirdLongClassName
   )
   from some_module import (
       LongClassName,
       AnotherLongClassName,
       ThirdLongClassName
   )
   ```

**Verification:**
- Before each file edit, run line-length check
- Do not proceed if violations found
- Fix all violations immediately after creating/editing

## Rule 2: No Trailing Whitespace (PYTHON FILES ONLY)

**Canonical Definition:** See [CODING_STANDARDS.md](CODING_STANDARDS.md)
section "No Trailing Whitespace" for complete details.

**Summary:** Python files shall have no spaces or tabs at line ends.

**When to Apply:**
- Python source files (.py): ALL lines
- Python test files: ALL lines
- Including blank lines (they should have zero characters)
- Note: This rule does NOT apply to other file types

**Validation Commands:**
See [CODING_STANDARDS.md section "Validation Command
Reference"](CODING_STANDARDS.md#validation-command-reference) for bash
commands to check trailing whitespace before and after editing.

**How to Comply:**
1. Never create lines with trailing spaces
2. When editing, ensure no spaces added at line ends
3. Blank lines should be truly blank (0 characters)

**Specific Attention Points:**
- When using `replace_string_in_file`: ensure newString has no trailing
  spaces
- When using `multi_replace_string_in_file`: verify each replacement
  string
- After generating code: automatically trim trailing whitespace

**Verification:**
- After each file edit, run trailing whitespace check
- If any violations found, immediately fix with:
  ```bash
  sed -i 's/[[:space:]]*$//' <filename>
  ```

## Rule 3: Proper Line Endings

**Canonical Definition:** See [CODING_STANDARDS.md](CODING_STANDARDS.md)
section "File Endings" for complete details.

**Summary:** All files must use Unix line endings (LF, not CRLF)

**Validation Commands:**
See [CODING_STANDARDS.md section "Validation Command
Reference"](CODING_STANDARDS.md#validation-command-reference) for bash
commands to check line endings.

## Pre-Edit Checklist (EXECUTE BEFORE EVERY EDIT)

Before making any changes to a PYTHON file, execute this checklist:

- [ ] **Line Length Check (Python only):** Run `awk 'length > 79' <file>`
  verify no lines exceed limit
- [ ] **Trailing Whitespace Check (Python only):** Run `grep -n " $"
  <file>` verify zero matches
- [ ] **Line Ending Check:** Run `file <file>` verify LF (not CRLF)
- [ ] **Understand the change:** Review context of what needs to change
- [ ] **Plan line breaks (Python only):** If adding new code, plan
  where lines will be broken to stay within 79 characters
- [ ] **Test the change:** After editing, re-run checks above for Python
  files

## Post-Edit Verification (EXECUTE AFTER EVERY EDIT)

After making any changes to a PYTHON file, execute this verification:

```bash
# Check for line length violations (Python files only)
LONG_LINES=$(awk 'length > 79' <file> | wc -l)
if [ $LONG_LINES -gt 0 ]; then
    echo "ERROR: $LONG_LINES lines exceed 79 characters"
    awk 'length > 79 {print NR": "length" chars"}' <file>
    exit 1
fi

# Check for trailing whitespace (Python files only)
TRAILING=$(grep -n " $" <file> | wc -l)
if [ $TRAILING -gt 0 ]; then
    echo "ERROR: $TRAILING lines have trailing whitespace"
    grep -n " $" <file>
    exit 1
fi

# Check line endings (all files)
file <file> | grep -q "LF line terminators" || \
    echo "WARNING: Check line endings"

echo "âœ“ Python file passes all quality checks"
```

## Exception Processing

**Only** in the following cases may these limits be temporarily exceeded:

1. **URLs in comments:** URLs may exceed 79 characters (document with
   comment explaining why)
2. **Generated code from output:** If copying output that's unavoidable,
   document the exception

**Even exceptions should be rare.** Plan code structure to avoid them.

## Non-Compliance Consequences

If a file is edited without following these rules:

1. Tests will likely fail
2. Pre-commit hooks will reject the changes
3. CI/CD pipeline will fail
4. The file must be reverted and re-edited correctly

## Additional Resources

For complete details on all topics, see
[CODING_STANDARDS.md](CODING_STANDARDS.md), which includes:
- Validation command reference (all bash commands)
- Configuration files guide
- Examples of fixing violations
- Tool reference (flake8, editorconfig, pre-commit hooks)
- Continuous integration information

## Questions?

Refer to [CODING_STANDARDS.md](CODING_STANDARDS.md) for detailed guidance,
examples, and all canonical rule definitions.

---

**IMPORTANCE:** These rules are MANDATORY for Python file changes.
**SCOPE:** 79-char and no-whitespace rules apply ONLY to Python files.
**FREQUENCY:** Apply this checklist on EVERY Python file modification.
**RESPONSIBILITY:** Agent must verify compliance before and after
EVERY Python edit.
